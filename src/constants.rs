// SPDX-License-Identifier: GPL-3.0-or-later
// Copyright (C) 2026 LTSU

//! Filter bank coefficients for DT-CWPT.
//!
//! Based on the Python prototype `constants.py`.
//! - Level 1: CDF 9/7 biorthogonal wavelet
//! - Level >= 2: Kingsbury Q-Shift 14-tap
//! - Packet extension: Q-Shift 14-tap (same for both trees per Theorem 1)

// ==============================================================================
// Level 1 Filters: CDF 9/7 Biorthogonal
// ==============================================================================

/// CDF 9/7 base lowpass analysis filter (9 taps)
const CDF_H0_BASE: [f64; 9] = [
    0.03782845550726404,
    -0.023849465019556843,
    -0.11062440441843718,
    0.37740285561283066,
    0.85269867900889385,
    0.37740285561283066,
    -0.11062440441843718,
    -0.023849465019556843,
    0.03782845550726404,
];

/// CDF 9/7 base highpass analysis filter (7 taps)
const CDF_H1_BASE: [f64; 7] = [
    -0.06453888262869706,
    0.04068941760916406,
    0.41809227322161724,
    -0.7884856164055829,
    0.41809227322161724,
    0.04068941760916406,
    -0.06453888262869706,
];

/// CDF 9/7 base lowpass synthesis filter (7 taps)
const CDF_G0_BASE: [f64; 7] = [
    -0.06453888262869706,
    -0.04068941760916406,
    0.41809227322161724,
    0.7884856164055829,
    0.41809227322161724,
    -0.04068941760916406,
    -0.06453888262869706,
];

/// CDF 9/7 base highpass synthesis filter (9 taps)
const CDF_G1_BASE: [f64; 9] = [
    -0.03782845550726404,
    -0.023849465019556843,
    0.11062440441843718,
    0.37740285561283066,
    -0.85269867900889385,
    0.37740285561283066,
    0.11062440441843718,
    -0.023849465019556843,
    -0.03782845550726404,
];

// --- Tree Re (CDF) ---
/// Analysis lowpass for Tree Re (10 taps: base + trailing zero)
pub const CDF_H0R: [f64; 10] = [
    0.03782845550726404,
    -0.023849465019556843,
    -0.11062440441843718,
    0.37740285561283066,
    0.85269867900889385,
    0.37740285561283066,
    -0.11062440441843718,
    -0.023849465019556843,
    0.03782845550726404,
    0.0,
];

/// Analysis highpass for Tree Re (8 taps: base + trailing zero)
pub const CDF_H1R: [f64; 8] = [
    -0.06453888262869706,
    0.04068941760916406,
    0.41809227322161724,
    -0.7884856164055829,
    0.41809227322161724,
    0.04068941760916406,
    -0.06453888262869706,
    0.0,
];

/// Synthesis lowpass for Tree Re (8 taps: leading zero + base)
pub const CDF_G0R: [f64; 8] = [
    0.0,
    -0.06453888262869706,
    -0.04068941760916406,
    0.41809227322161724,
    0.7884856164055829,
    0.41809227322161724,
    -0.04068941760916406,
    -0.06453888262869706,
];

/// Synthesis highpass for Tree Re (10 taps: leading zero + base)
pub const CDF_G1R: [f64; 10] = [
    0.0,
    -0.03782845550726404,
    -0.023849465019556843,
    0.11062440441843718,
    0.37740285561283066,
    -0.85269867900889385,
    0.37740285561283066,
    0.11062440441843718,
    -0.023849465019556843,
    -0.03782845550726404,
];

/// Delay for Tree Re level 1 filters
pub const CDF_DELAY_RE: usize = 8;

// --- Tree Im (1-sample delayed version) ---
/// Analysis lowpass for Tree Im (10 taps: leading zero + base)
pub const CDF_H0I: [f64; 10] = [
    0.0,
    0.03782845550726404,
    -0.023849465019556843,
    -0.11062440441843718,
    0.37740285561283066,
    0.85269867900889385,
    0.37740285561283066,
    -0.11062440441843718,
    -0.023849465019556843,
    0.03782845550726404,
];

/// Analysis highpass for Tree Im (8 taps: leading zero + base)
pub const CDF_H1I: [f64; 8] = [
    0.0,
    -0.06453888262869706,
    0.04068941760916406,
    0.41809227322161724,
    -0.7884856164055829,
    0.41809227322161724,
    0.04068941760916406,
    -0.06453888262869706,
];

/// Synthesis lowpass for Tree Im (8 taps: base + trailing zero)
pub const CDF_G0I: [f64; 8] = [
    -0.06453888262869706,
    -0.04068941760916406,
    0.41809227322161724,
    0.7884856164055829,
    0.41809227322161724,
    -0.04068941760916406,
    -0.06453888262869706,
    0.0,
];

/// Synthesis highpass for Tree Im (10 taps: base + trailing zero)
pub const CDF_G1I: [f64; 10] = [
    -0.03782845550726404,
    -0.023849465019556843,
    0.11062440441843718,
    0.37740285561283066,
    -0.85269867900889385,
    0.37740285561283066,
    0.11062440441843718,
    -0.023849465019556843,
    -0.03782845550726404,
    0.0,
];

/// Delay for Tree Im level 1 filters
pub const CDF_DELAY_IM: usize = 8;

// ==============================================================================
// Level >= 2 Filters: Kingsbury Q-Shift 14-tap
// ==============================================================================

// --- Tree Re (Basic Q-Shift) ---
/// Q-Shift 14-tap analysis lowpass for Tree Re
pub const QSHIFT14_H0R: [f64; 14] = [
    0.0032531427636532,
    -0.0038832119991585,
    0.0346603468448535,
    -0.0388728012688278,
    -0.1172038876991153,
    0.2752953846688820,
    0.7561456438925225,
    0.5688104207121227,
    0.0118660920337970,
    -0.1067118046866654,
    0.0238253847949203,
    0.0170252238815540,
    -0.0054394759372741,
    -0.0045568956284755,
];

/// Q-Shift 14-tap analysis highpass for Tree Re
pub const QSHIFT14_H1R: [f64; 14] = [
    -0.0045568956284755,
    0.0054394759372741,
    0.0170252238815540,
    -0.0238253847949203,
    -0.1067118046866654,
    -0.0118660920337970,
    0.5688104207121227,
    -0.7561456438925225,
    0.2752953846688820,
    0.1172038876991153,
    -0.0388728012688278,
    -0.0346603468448535,
    -0.0038832119991585,
    -0.0032531427636532,
];

/// Q-Shift 14-tap synthesis lowpass for Tree Re
pub const QSHIFT14_G0R: [f64; 14] = [
    -0.0045568956284755,
    -0.0054394759372741,
    0.0170252238815540,
    0.0238253847949203,
    -0.1067118046866654,
    0.0118660920337970,
    0.5688104207121227,
    0.7561456438925225,
    0.2752953846688820,
    -0.1172038876991153,
    -0.0388728012688278,
    0.0346603468448535,
    -0.0038832119991585,
    0.0032531427636532,
];

/// Q-Shift 14-tap synthesis highpass for Tree Re
pub const QSHIFT14_G1R: [f64; 14] = [
    -0.0032531427636532,
    -0.0038832119991585,
    -0.0346603468448535,
    -0.0388728012688278,
    0.1172038876991153,
    0.2752953846688820,
    -0.7561456438925225,
    0.5688104207121227,
    -0.0118660920337970,
    -0.1067118046866654,
    -0.0238253847949203,
    0.0170252238815540,
    0.0054394759372741,
    -0.0045568956284755,
];

/// Delay for Tree Re Q-Shift filters
pub const QSHIFT14_DELAY_RE: usize = 13;

// --- Tree Im (Time-Reverse of Tree Re) ---
/// Q-Shift 14-tap analysis lowpass for Tree Im
pub const QSHIFT14_H0I: [f64; 14] = [
    -0.0045568956284755,
    -0.0054394759372741,
    0.0170252238815540,
    0.0238253847949203,
    -0.1067118046866654,
    0.0118660920337970,
    0.5688104207121227,
    0.7561456438925225,
    0.2752953846688820,
    -0.1172038876991153,
    -0.0388728012688278,
    0.0346603468448535,
    -0.0038832119991585,
    0.0032531427636532,
];

/// Q-Shift 14-tap analysis highpass for Tree Im
pub const QSHIFT14_H1I: [f64; 14] = [
    -0.0032531427636532,
    -0.0038832119991585,
    -0.0346603468448535,
    -0.0388728012688278,
    0.1172038876991153,
    0.2752953846688820,
    -0.7561456438925225,
    0.5688104207121227,
    -0.0118660920337970,
    -0.1067118046866654,
    -0.0238253847949203,
    0.0170252238815540,
    0.0054394759372741,
    -0.0045568956284755,
];

/// Q-Shift 14-tap synthesis lowpass for Tree Im
pub const QSHIFT14_G0I: [f64; 14] = [
    0.0032531427636532,
    -0.0038832119991585,
    0.0346603468448535,
    -0.0388728012688278,
    -0.1172038876991153,
    0.2752953846688820,
    0.7561456438925225,
    0.5688104207121227,
    0.0118660920337970,
    -0.1067118046866654,
    0.0238253847949203,
    0.0170252238815540,
    -0.0054394759372741,
    -0.0045568956284755,
];

/// Q-Shift 14-tap synthesis highpass for Tree Im
pub const QSHIFT14_G1I: [f64; 14] = [
    -0.0045568956284755,
    0.0054394759372741,
    0.0170252238815540,
    -0.0238253847949203,
    -0.1067118046866654,
    -0.0118660920337970,
    0.5688104207121227,
    -0.7561456438925225,
    0.2752953846688820,
    0.1172038876991153,
    -0.0388728012688278,
    -0.0346603468448535,
    -0.0038832119991585,
    -0.0032531427636532,
];

/// Delay for Tree Im Q-Shift filters
pub const QSHIFT14_DELAY_IM: usize = 13;

// ==============================================================================
// Packet Extension Filters
// Per Theorem 1 (Bayram & Selesnick), use same filters for both trees
// ==============================================================================

/// Packet analysis lowpass (same as QSHIFT14_H0R)
pub const PACKET_H0: [f64; 14] = QSHIFT14_H0R;

/// Packet analysis highpass (same as QSHIFT14_H1R)
pub const PACKET_H1: [f64; 14] = QSHIFT14_H1R;

/// Packet synthesis lowpass (same as QSHIFT14_G0R)
pub const PACKET_G0: [f64; 14] = QSHIFT14_G0R;

/// Packet synthesis highpass (same as QSHIFT14_G1R)
pub const PACKET_G1: [f64; 14] = QSHIFT14_G1R;

/// Delay for packet filters
pub const PACKET_DELAY: usize = 13;

// ==============================================================================
// Maximum filter length (for buffer sizing)
// ==============================================================================

/// Maximum filter tap count across all filter banks
pub const MAX_FILTER_LEN: usize = 14;
